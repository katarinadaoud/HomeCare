@{
    ViewData["Title"] = "My appointments";
    Layout = "_Layout";
}

<!-- Top navigation -->
<nav class="navbar bg-white fixed-top" role="navigation" aria-label="Main menu">
  <div class="container-fluid topnav">
    <a class="navbar-brand d-flex align-items-center gap-2 brand" href="#mine-timeavtaler" aria-label="Home">
      <svg class="brand-icon" width="28" height="28" viewBox="0 0 24 24" role="img" aria-hidden="true">
        <path d="M12 4c2-2.5 6-2.7 8.2-.6 2.9 2.5 3.2 7 .6 9.6-2.3 2.5-6.9 6-8.5 7.1-.2.1-.5.1-.7 0-1.6-1.1-6.2-4.6-8.5-7.1-2.6-2.6-2.3-7.1.6-9.6C6 1.3 10 1.5 12 4Z"
              fill="none" stroke="var(--brand-accent)" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"
              transform="translate(12 12) scale(1.12) translate(-12 -12)" />
        <path d="M5.2 11.2 12 5.8l6.8 5.4v5.9c0 .5-.4.9-.9.9h-4.2a.6.6 0 0 1-.6-.6v-2.6a2 2 0 0 0-2-2h-1.2a2 2 0 0 0-2 2v2.6a.6.6 0 0 1-.6.6H6.1a.9.9 0 0 1-.9-.9z"
              fill="currentColor" opacity="0.96"/>
      </svg>
      <span class="brand-text"><span class="brand-L">L</span>ife<span class="brand-L">L</span>ink</span>
    </a>

    <ul class="nav ms-2" role="list">
      <li class="nav-item"><a class="nav-link" href="#mine-timeavtaler" aria-current="page">My appointments</a></li>
      <li class="nav-item"><a class="nav-link" href="#mine-medisiner">My medications</a></li>
    </ul>

    <div class="ms-auto d-flex align-items-center gap-3">
      <a href="#book-time" class="btn-cta">Book appointment</a>

      <button class="icon-btn" id="notifBtn" type="button" aria-label="Notifications">
        <span aria-hidden="true">ðŸ””</span>
        <span class="badge" id="notifBadge">2</span>
      </button>

      <span class="toolbar-sep" aria-hidden="true"></span>

      <button class="icon-btn sos-btn" id="sosBtn" type="button" aria-label="Emergency: call home-care service">
        <svg width="22" height="22" viewBox="0 0 24 24" role="img" aria-hidden="true">
          <path fill="currentColor"
            d="M6.62 10.79a15.46 15.46 0 006.59 6.59l2.2-2.2a1 1 0 011.02-.24c1.12.37 2.33.57 3.57.57a1 1 0 011 1V20a1 1 0 01-1 1C11.85 21 3 12.15 3 1a1 1 0 011-1h3.49a1 1 0 011 1c0 1.24.19 2.45.57 3.57a1 1 0 01-.24 1.02l-2.2 2.2z"/>
        </svg>
      </button>
    </div>
  </div>
</nav>

<!-- Content -->
<main id="main" class="container app-container" tabindex="-1">
  <section id="view-mine-timeavtaler" class="app-view" aria-labelledby="mt-heading" hidden>
    <header class="mb-2"><h1 id="mt-heading" class="h4 fw-bold mb-0">My appointments</h1></header>

    <div id="kalWrap">
      <div id="kalHeader" aria-live="polite">
        <div class="kal-controls" role="group" aria-label="Month navigation">
          <button class="kal-btn" type="button" id="btnPrev" aria-label="Previous month">â€¹</button>
          <button class="kal-btn" type="button" id="btnToday" aria-label="Go to today">Today</button>
          <button class="kal-btn" type="button" id="btnNext" aria-label="Next month">â€º</button>
          <input type="date" id="jumpDate" class="kal-date" aria-label="Jump to date">
        </div>

        <div class="title" id="kalTittel"></div>

        <div class="view-toggle" role="group" aria-label="View mode">
          <button class="toggle" id="btnViewMonth" type="button" aria-pressed="true" aria-label="Calendar view">Calendar</button>
          <button class="toggle" id="btnViewList" type="button" aria-pressed="false" aria-label="List view">List</button>
        </div>
      </div>

      <div id="kal" role="region" aria-label="Calendar"></div>

      <div class="empty-state" id="emptyState" aria-live="polite">
        <span>No appointments in this period.</span>
        <a class="btn btn-sm btn-outline-primary" href="#book-time">Book appointment</a>
      </div>
    </div>
  </section>

  <!-- Placeholders -->
  <section id="view-book-time" class="app-view" aria-labelledby="bt-heading" hidden>
    <header class="mb-2"><h1 id="bt-heading" class="h4 fw-bold mb-0">Book appointment</h1></header>
    <p>(Coming soon.) You can also choose provider here.</p>
  </section>

  <section id="view-mine-medisiner" class="app-view" aria-labelledby="mm-heading" hidden>
    <header class="mb-2"><h1 id="mm-heading" class="h4 fw-bold mb-0">My medications</h1></header>
    <p>(Coming soon.)</p>
  </section>
</main>

<!-- SOS confirmation -->
<div class="modal fade" id="sosConfirmModal" tabindex="-1" aria-labelledby="sosConfirmTitle" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content">
      <div class="modal-header">
        <h2 class="modal-title fs-5" id="sosConfirmTitle">Call the home-care service?</h2>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">Are you sure you want to call the home-care service now?</div>
      <div class="modal-footer">
        <button type="button" class="btn btn-outline-secondary" data-bs-dismiss="modal">Cancel</button>
        <button type="button" class="btn btn-danger" id="sosConfirmCallBtn" aria-label="Call now">Call</button>
      </div>
    </div>
  </div>
</div>

<!-- Toasts -->
<div class="toast-container position-fixed top-0 end-0 p-3">
  <div id="alarmToast" class="toast align-items-center text-bg-danger border-0" role="status" aria-live="polite" aria-atomic="true">
    <div class="d-flex">
      <div class="toast-body">Calling the home-care serviceâ€¦</div>
      <button type="button" class="btn-close btn-close-white me-2 m-auto" data-bs-dismiss="toast" aria-label="Close"></button>
    </div>
  </div>
  <div id="notifToast" class="toast align-items-center text-bg-primary border-0" role="status" aria-live="polite" aria-atomic="true">
    <div class="d-flex">
      <div class="toast-body">You have 2 new notifications.</div>
      <button type="button" class="btn-close btn-close-white me-2 m-auto" data-bs-dismiss="toast" aria-label="Close"></button>
    </div>
  </div>
  <div id="deskToast" class="toast align-items-center text-bg-light border" role="status" aria-live="polite" aria-atomic="true">
    <div class="d-flex">
      <div class="toast-body">
        Phone number to home-care service: <strong id="deskPhoneText"></strong>
        <button class="btn btn-sm btn-outline-secondary ms-2" id="copyBtn">Copy</button>
      </div>
      <button type="button" class="btn-close me-2 m-auto" data-bs-dismiss="toast" aria-label="Close"></button>
    </div>
  </div>
</div>
