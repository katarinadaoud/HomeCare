@using Microsoft.AspNetCore.Identity
@using HomeCareApp.Models
@inject SignInManager<User> SignInManager
@inject UserManager<User> UserManager

<nav class="navbar bg-white fixed-top" role="navigation" aria-label="Main menu">
  <div class="container-fluid topnav">
    <a class="navbar-brand d-flex align-items-center gap-2 brand"
        href="/Patient/Index" aria-label="Home">
      <svg class="brand-icon" width="28" height="28" viewBox="0 0 24 24" role="img" aria-hidden="true">
        <path d="M12 4c2-2.5 6-2.7 8.2-.6 2.9 2.5 3.2 7 .6 9.6-2.3 2.5-6.9 6-8.5 7.1-.2.1-.5.1-.7 0-1.6-1.1-6.2-4.6-8.5-7.1-2.6-2.6-2.3-7.1.6-9.6C6 1.3 10 1.5 12 4Z"
              fill="none" stroke="var(--brand-accent)" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"
              transform="translate(12 12) scale(1.12) translate(-12 -12)" />
        <path d="M5.2 11.2 12 5.8l6.8 5.4v5.9c0 .5-.4.9-.9.9h-4.2a.6.6 0 0 1-.6-.6v-2.6a2 2 0 0 0-2-2h-1.2a2 2 0 0 0-2 2v2.6a.6.6 0 0 1-.6.6H6.1a.9.9 0 0 1-.9-.9z"
              fill="currentColor" opacity="0.96"/>
      </svg>
      <span class="brand-text"><span class="brand-L">L</span>ife<span class="brand-L">L</span>ink</span>
    </a>

    <ul class="nav ms-2" role="list">
      <li class="nav-item"><a class="nav-link" href="#mine-timeavtaler" aria-current="page">My appointments</a></li>
      
      <li class="nav-item">
        <a class="nav-link @(ViewBag.ActiveTab=="medications" ? "active" : "")"
           asp-controller="Medication" asp-action="Table">My medications</a>
      </li>

      @*  My profile with icon *@
      @if (SignInManager.IsSignedIn(User))
      {
          <li class="nav-item d-flex align-items-center">
              <a class="nav-link d-flex align-items-center gap-1"
                 asp-area="Identity" asp-page="/Account/Manage/Index">
                  <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18"
                       viewBox="0 0 24 24" fill="none" stroke="currentColor"
                       stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                       class="lucide lucide-user">
                      <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"/>
                      <circle cx="12" cy="7" r="4"/>
                  </svg>
                  My profile
              </a>
          </li>
      }
    </ul>

    <div class="ms-auto d-flex align-items-center gap-3">

      <a asp-controller="Appointment" asp-action="Book" class="btn-cta">Book appointment</a>

      <button class="icon-btn" id="notifBtn" type="button" aria-label="Notifications">
        <span aria-hidden="true">ðŸ””</span>
        <span class="badge" id="notifBadge"></span>  <!-- no number -->
      </button>


      <span class="toolbar-sep" aria-hidden="true"></span>

      <button class="icon-btn sos-btn" id="sosBtn" type="button" aria-label="Emergency: call home-care service">
        <svg width="22" height="22" viewBox="0 0 24 24" role="img" aria-hidden="true">
          <path fill="currentColor"
            d="M6.62 10.79a15.46 15.46 0 006.59 6.59l2.2-2.2a1 1 0 011.02-.24c1.12.37 2.33.57 3.57.57a1 1 0 011 1V20a1 1 0 01-1 1C11.85 21 3 12.15 3 1a1 1 0 011-1h3.49a1 1 0 011 1c0 1.24.19 2.45.57 3.57a1 1 0 0 1-.24 1.02l-2.2 2.2z"/>
        </svg>
      </button>

      @* Signout-icon *@
      @if (SignInManager.IsSignedIn(User))
      {
          <form id="logoutForm" asp-area="Identity" asp-page="/Account/Logout"
                asp-route-returnUrl="@Url.Action("Index", "Home", new { area = "" })">
              <button id="logout" type="submit" class="icon-btn logout-btn" aria-label="Logout">
                  <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24" fill="none"
                       stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                       class="lucide lucide-log-out">
                      <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4" />
                      <polyline points="16 17 21 12 16 7" />
                      <line x1="21" y1="12" x2="9" y2="12" />
                  </svg>
              </button>
          </form>
      }
    </div>
  </div>
</nav>
